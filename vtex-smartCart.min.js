/**
* Vtex Smart Cart
* @author Carlos Vinicius
* @version 4.3
* @date 2012-13-11
*/
"function"!=typeof jQuery.fn.vtexPopUp2&&(jQuery.fn.vtexPopUp2=function(s){var e=jQuery(this);if(1>e.length)return e;var c=jQuery("body"),l=c.find(".boxPopUp2"),k="object"==typeof console;1>l.length&&(l=jQuery('<div class="boxPopUp2"><div class="boxPopUp2-wrap"><span class="boxPopUp2-close"></span><div class="boxPopUp2-content"></div></div></div>'),c.prepend(l),l.after('<div class="boxPopUp2-overlay"></div>'));var d=jQuery.extend({popupType:null,closeContent:null,popupClass:"",quickViewClass:".quickViewLink",
initCallback:function(){},showCallback:function(){},closeCallback:function(){}},s),s=l.find(".boxPopUp2-close"),i=l.find(".boxPopUp2-content"),v=c.find(".boxPopUp2-close, .boxPopUp2-overlay"),n=c.find(".boxPopUp2-overlay"),t=jQuery(document);null!=d.closeContent&&s.html(d.closeContent);var b={positioning:function(){var a=t.scrollTop(),b=jQuery(window).height(),c=l.outerHeight(!0);l.css("top",a+(c>=b?20:(b-c)/2)+"px")},show:function(a){a=a||{};n.fadeTo("fast",0.5,function(){l.show().addClass("popupOpened");
"boolean"===typeof a.loading&&!0===a.loading?b.showLoading():b.hideLoading();"function"===typeof a.callback&&a.callback();d.showCallback(l)})},hideLoading:function(){i.filter(":visible").css("background-image","none")},showLoading:function(){i.filter(":visible").css("background-image",'url("/arquivos/ajax-loader.gif")')},close:function(a){var a=a||{},b=function(){n.fadeOut("fast");l.fadeOut("fast",function(){i.empty()});i.attr("class","boxPopUp2-content");l.attr("class","boxPopUp2")};"boolean"==typeof a.closeNow&&
!0==a.closeNow&&b();1>v.filter(".boxPopUp2-clickActive").length&&(v.addClass("boxPopUp2-clickActive").bind("click",function(){"function"===typeof a.clickCallback?a.clickCallback():d.closeCallback(l);b()}),t.bind("keyup",function(a){27==(a.keyCode?a.keyCode:a.which)&&b()}));if(e.hasClass("autoClose")){var c=(e.attr("class")||"").split("ac_").pop().split(" ").shift();if(isNaN(parseFloat(c)))return k&&console.log("[Erro] O tempo informado (em segundos) n\u00e3o \u00e9 um valor num\u00e9rico: \u201c"+
c+"\u201d"),!1;setTimeout(function(){b()},1E3*c)}},setType:function(a){if(a.hasClass("quickViewLink"))b.quickView(a);else if(a.hasClass("giftListWrap"))b.giftList(a);else if(a.hasClass("installmentInfoTpl"))b.paymentForms(a);else if(a.hasClass("shipping-value"))b.calculateShipping(a);else if(a.hasClass("freeContent"))b.freeContent(a);else if(a.hasClass("boxPopUp2"))b.closeNow(a);else if(a.hasClass("referAFriendTpl"))b.productReferAFriend(a);else if(0<a.filter("#btnReferAFriend").length)b.giftListReferFriend(a);
else if(0<a.filter("#lnkPubliqueResenha").length)b.postRatingComment(a);else if(0<a.filter("#palerta").length)b.cartCheckoutAlert(a);else if(a.hasClass("lnkAddPhoto"))d.popupType="minhaContaFoto",b.userAccount(a);else return!1},checkType:function(a){"cadastroCliente"===d.popupType||"minhaContaFoto"===d.popupType?b.userAccount(a):"newsletter"===d.popupType?b.newsletter(a):"quickview"===d.popupType?b.quickView(a):"giftlist"===d.popupType?b.giftList(a):"paymentforms"===d.popupType?b.paymentForms(a):
"shipping"===d.popupType?b.calculateShipping(a):"string"==typeof d.popupType&&"freecontent"===d.popupType.toLowerCase()?b.freeContent(a):"closenow"===d.popupType?b.closeNow(a):"GiftListReferAFriend"===d.popupType?b.giftListReferFriend(a):"postRatingComment"===d.popupType?b.postRatingComment(a):b.freeContent(a)},exec:function(){e.each(function(){var a=$(this);null===d.popupType?b.setType(a):!1===b.checkType(a)&&b.setType(a)});d.initCallback()},userAccount:function(a){var c="";"cadastroCliente"===d.popupType?
c="signInPopups":"minhaContaFoto"===d.popupType&&(c="profilePhoto");a.unbind().removeAttr("onclick");var e=a.attr("href")||"";a.bind("mouseenter",function(){a.unbind().bind("click",function(){l.addClass(d.popupClass+" "+c+"Main");""===e&&k&&console.log("N\u00e3o existe URL no atributo href");jQuery('<iframe src="'+e+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(i.addClass(d.popupClass+" "+c));b.show({loading:!0});b.positioning();b.close();return!1})})},newsletter:function(a){a.clone().appendTo(i.addClass(d.popupClass+
" newsletterPopup"));l.addClass(d.popupClass+" newsletterMain");b.show();b.positioning();b.close()},quickView:function(a){var a=c.find(d.quickViewClass),e=function(){a.filter(":not(.quickViewLinkActivated)").addClass("quickViewLinkActivated").bind("click",function(){jQuery('<iframe src="'+jQuery(this).attr("href")+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(i.addClass(d.popupClass+" productQuickView"));l.addClass(d.popupClass+" quickViewMain");b.show({loading:!0});b.positioning();
b.close();return!1})};e();t.ajaxStop(e)},paymentForms:function(a){var e="",w=function(){var a=c.find(".see-other-payment-method-link");if(1>a.length)return k&&console.log("Url das formas de pagamento n\u00e3o encontrado. \n Verifique se o controle esta na p\u00e1gina.\n("+a.selector+")"),!1;e=/http:(.*?)(?=\&)/.exec(a[0].getAttribute("onclick").toString())[0]||"#onclickError"};w();a.bind("click",function(){jQuery("<iframe src='"+e+"' frameborder='0' allowtransparency='true'></iframe>").appendTo(i.addClass(d.popupClass+
" paymentFormsPopup"));l.addClass(d.popupClass+" paymentFormsMain");b.show({loading:!0});b.positioning();b.close();return!1});t.ajaxStop(w)},calculateShipping:function(){t.ajaxStop(function(){var a=c.find("#calculoFrete").children();if(1>a.length)return!1;a.find("span.cep-busca a").attr("target","_blank");a.appendTo(i.addClass(d.popupClass+" shippingCalculationPopup"));l.addClass(d.popupClass+" shippingCalculationMain");b.show();b.positioning();b.close()})},giftList:function(a){a.appendTo(i.addClass(d.popupClass+
" giftListPopup"));l.addClass(d.popupClass+" giftListMain");b.show();b.positioning();b.close({clickCallback:d.closeCallback})},cartCheckoutAlert:function(a){a.appendTo(i.addClass(d.popupClass+" cartCheckoutAlertPopup"));l.addClass(d.popupClass+" cartCheckoutAlertMain");b.show();b.positioning();b.close()},freeContent:function(a){a.appendTo(i.addClass(d.popupClass+" freeContentPopup"));l.addClass(d.popupClass+" freeContentMain");b.show();b.positioning();b.close()},closeNow:function(){b.close({closeNow:!0})},
giftListReferFriend:function(a){var c=function(){var a=$(this).attr("href");if("undefined"===typeof a||""===a)return k&&console.log("[Erro] Url do popup n\u00e3o encontrada."),!1;i.addClass(d.popupClass+" freeContentPopup").load(a);l.addClass(d.popupClass+" giftListReferFriendMain");b.show({loading:!0});b.positioning();b.close();return!1},e=function(){a.unbind().bind("mouseenter",function(){a.unbind().bind("click",c)})};e();t.ajaxStop(e)},productReferAFriend:function(a){var c=jQuery('<div class="referAFriendPopUpWrap"></div>');
a.bind("click",function(){var a=(jQuery(this).parent().find("#div-referAFriend input").attr("onclick")||"").toString(),a=/\/referAFriend\/Form\/[0-9]+\?/i.exec(a);if(null===a)return alert("Desculpe, n\u00e3o foi poss\u00edvel abrir o formul\u00e1rio."),!1;c.empty().load(a[0],function(){b.positioning()});c.appendTo(i.addClass(d.popupClass+" freeContentPopup"));l.addClass(d.popupClass+" freeContentMain");b.show();b.positioning();b.close();return!1});t.ajaxStop(function(){0<i.find(".referAFriendPopUpWrap #btnFechar").length&&
setTimeout(b.closeNow,1500)})},postRatingComment:function(a){var a=a.filter(":not(.popUpPublishReviewActivated)"),c=!1;if(1>a.length)return!1;a.bind("click",function(){var a=jQuery(this).attr("href")||"";if(""===a)return k&&console.log("[Erro] N\u00e3o foi poss\u00edvel obter os dados para abrir o popup de resenha."),!1;a=a.split(")").shift().split("(").pop().split(",");if(3!=a.length)return k&&console.log("[Erro] O array com os dados do cliente retornou um valor inesperado."),!1;if(c)return!1;c=
!0;jQuery.ajax({url:"/publishuserreviewcomment",type:"POST",data:{productId:a[1],clientId:a[0],categoryId:a[2]},success:function(a){var e=jQuery(a);i.addClass(d.popupClass+" userReviewPopup").html(e);l.addClass(d.popupClass+" userReviewPopupMain");b.show({callback:function(){e.find("#txtTituloResenha:hidden").val("titulo_auto");var a=i.find("a#rtAvaliacao_A0"),c=function(){a.attr("title",a.find(".filledRatingStar:last").index()+1||0)};a.find("span").bind("mouseenter",c);a.bind("mouseleave",c)}});
b.positioning();b.close();c=!1},error:function(){c=!1}});return!1}).addClass("popUpPublishReviewActivated");0==jQuery.fn.vtexPopUp2.data.userReviewCount&&t.ajaxStop(function(){i.hasClass("userReviewPopup")&&0==i.find(".formUserComment").children().length&&b.closeNow()});jQuery.fn.vtexPopUp2.data.userReviewCount++}};b.exec();return e},jQuery.fn.vtexPopUp2.data={userReviewCount:0});
(function(s){s.fn.getAttributes=function(){var e={},c=s(this).first();if(!c.length)return this;s.each(c[0].attributes,function(c,k){e[k.name]=k.value});return e}})(jQuery);"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()});var vtexscCartHideTimeOut=0;
jQuery.fn.smartCart=function(s){var e=function(g,a){"object"==typeof console&&console.log("[Smart Cart - "+(a||"Erro")+"] "+g)},c=jQuery.extend({method:1,htmlFormat:2,skuThumbId:3,cartElem:".vtexsc-cart",listElem:".vtexsc-productList",scrollTop:".vtexsc-arrowTop",scrollDown:".vtexsc-arrowBottom",btnOverlayElem:".vtexsc-buttonOverlay",errorElem:".vtexsc-error",successElem:".vtexsc-success",showCartBtn:".vtexsc-showCart",totalCart:".vtexsc-totalCart",buyButton:".vtexsc-buyButton",asynchronousClass:"btn-add-buy-button-asynchronous",
qttText:"",textRemove:"",textMoreOne:"",textMinusOne:"",firstOptionMsg:"Selecione um(a) ",ajaxErroMsg:"Houve um erro ao tentar adicionar/alterar seu produto no carrinho.",changeQttError:"Provavelmente esta altera\u00e7\u00e3o n\u00e3o obteve \u00eaxito!",skuNotSelected:"Selecione o(a) #groupName",skuNotLocated:"N\u00e3o foi poss\u00edvel obter as informa\u00e7\u00f5es das varia\u00e7\u00f5es deste produto.\nVoc\u00ea ser\u00e1 redirecionado para a p\u00e1gina de detalhes deste produto.",skuUnavailable:"Esta varia\u00e7\u00e3o de produto n\u00e3o esta disponp\u00edvel no momento.",
regularPricePopupHtml:'<div class="regularPrice">De: <span>R$ #regularPrice</span></div>',newPricePopupHtml:'<div class="newPrice">Por: <span>R$ #newPrice</span></div>',installmentPricePopupHtml:'<div class="installmentPrice">ou em at\u00e9 <span>#installmentQtt</span>X de <span>R$ #installmentValue</span> sem juros</div>',fullPricePopupHtml:'<div class="fullPrice">\u00e0 vista</div>',currency:"R$",cartHideTime:5E3,notAjaxStop:!1,callback:function(){},ajaxCallback:function(){},succesShow:function(g){g.show()},
cartShow:function(g,a){g.slideDown(a)},cartHide:function(g,a,c){clearTimeout(vtexscCartHideTimeOut);vtexscCartHideTimeOut=setTimeout(function(){a(g)},c)},resetNewItem:function(g){setTimeout(function(){g.removeClass("vtexsc-newItem")},2500)},getSkuHtml:function(g){return g.find("ul.topic")},formatSkuPopup:function(g,a,c,b){var j,h,m,d,q;j=jQuery('<div class="skuWrap_"><div class="selectSkuTitle">Selecione a varia\u00e7\u00e3o do produto</div></div>');q=jQuery('<div class="vtexsm-prodTitle"></div>');
h=jQuery('<div class="skuListWrap_"></div>');m=jQuery('<div class="vtexsc-buttonWrap clearfix"><a href="#" class="vtexsc-buyButton"></a></div>');d=jQuery('<div class="vtexsc-skusWrap"></div>');jQuery("div");g.appendTo(h);a.appendTo(d);h.appendTo(d);c.appendTo(d);q.append(b);q.appendTo(j);d.appendTo(j);m.appendTo(j);return j}},s),l=jQuery(this),k=jQuery(""),d=jQuery(c.cartElem),i=!0,s=!1,v={};1>l.length&&0<d.length&&(s=!0,i=!1);if(1>l.length&&i)return l;if(1>d.length&&i)return e("Elemento do carrinho n\u00e3o encontrado \n ("+
d.selector+")"),!1;var n=d.find(c.listElem);if(1>n.length&&i)return e("Lista de produtos n\u00e3o encontrada \n ("+n.selector+")"),!1;jQuery(c.errorElem);var t=jQuery(c.successElem)||k,b=jQuery(c.showCartBtn)||k,a={},E=d.find(c.scrollDown)||k,w=d.find(c.scrollTop)||k,i=jQuery(c.totalCart)||k,D=jQuery("<span class='vtexsc-text'></span>"),z=jQuery("<div class='vtexsc-overlay'></div>"),A=k,x,B;i.children(".vtexsc-overlay").length||i.append(z);B=i.children(".vtexsc-text");B.length?x=B:(i.append(D),x=
D);var f={buyButtons:function(){l.not(".vtexsm_activated").each(function(){var g=jQuery(this);!g.hasClass("actionActivated")&&f.buyAsynchronous(g)&&g.addClass("actionActivated").bind("click",function(){if(-1<(g.attr("href")||"").indexOf("elecione"))return!0;var a=f.getSku(g);""!==a?f.skuToCart(g,a):e("O Sku n\u00e3o foi obtido! A execu\u00e7\u00e3o parou");return!1})}).addClass("vtexsm_activated")},buyAsynchronous:function(a){if(!a.hasClass(c.asynchronousClass))return!0;a.unbind("click").removeClass(c.asynchronousClass).addClass("asynchronousBuyButton");
if(a.hasClass("remove-href"))return!0;f.multiplesSkus(a);return!1},multiplesSkus:function(a){a.bind("click",function(){var y,p,b,j;y=a.attr("href")||"";if(""==y)return e("N\u00e3o foi poss\u00edvel obter a URL para a p\u00e1gina do produto \n m\u00e9todo: multiplesSkus"),!1;p=a.siblings(c.btnOverlayElem).show();b=jQuery('<div class="vtexsc-skuProductImage"></div>');j=jQuery('<div class="vtexsc-skuProductPrice"></div>');f.skuProductImg(b,a);jQuery.ajax({url:y,success:function(c){f.productSuccess(c,
y,p,b,j,a)},error:function(){e("Erro ao requisitar a p\u00e1gina do produto via Ajax")}});return!1})},skuProductImg:function(a,c){f.getParent(c,"li").find("a[href$='/p'] img").first().clone().appendTo(a)},getParent:function(a,c){var b;b=a.parent();return b.is("html")?jQuery(""):b.is(c)?b:b.length?f.getParent(b,c):b},productSuccess:function(a,b,p,d,j,h){var m,r,q;m=jQuery(a);a=c.getSkuHtml(m);r=!1;q=null;m.filter("script:not([src])").each(function(){var a=this.innerHTML;if(-1<a.indexOf("myJSONSkuSpecification"))return a=
a.replace(":,",':"",').replace(":}",':""}').replace(":]",':""]'),eval(a),q=myJSONSkuSpecification,r=!0,!1});if(!r)return e("N\u00e3o foi poss\u00edvel localizar as especifica\u00e7\u00f5es do SKU. \n A p\u00e1gina ser\u00e1 redirecionada!"),setTimeout(function(){document.location.href=b},500),!1;h=f.getParent(h,"li");m=h.find("a:first").attr("title");h="undefined"!=typeof m&&""!=m?m:h.find("a:eq(1)").text();c.formatSkuPopup(a,d,j,h).addClass("freeContent vtexsc-selectSku").vtexPopUp2({popupClass:"vtexsm-popupContent"});
q=f.specificationsReorder(q);A=jQuery(c.buyButton)||k;h=a.find("[type=checkbox]");m=a.find("select.sku-selector");if(0<h.length)tempChks=jQuery(""),h.each(function(){var a=jQuery(this),g=a.getAttributes(),g=jQuery('<input type="radio" name="'+g.name+'" specification="'+(g.specification||"")+'" class="'+(g["class"]||"")+'" id="'+(g.id||"")+'" value="'+g.value+'" />');a.after(g);a.remove();tempChks=tempChks.add(g)}),h=tempChks,p.hide(),1<q.specifications?f.multipleSkuConfigCheckbox(a,q,h,d,j):f.skuConfigCheckbox(a,
q,h,d,j),f.buyButtonCheckbox(h,q,a,b,p);else if(0<m.length){if(1<m.length)return e("Este plugin ainda n\u00e3o suporta mais de 1 selectbox.");p.hide();f.skuConfigSelectbox(a,q,m,d,j);f.buyButtonSelectbox(m,q,a,b,p)}else e("Elemento n\u00e3o previsto")},skuConfigSelectbox:function(a,b,p,d,j){var h,a=p.find("option:first");h=p.parent().siblings(".specification");""==a.text().trim()&&""!=c.firstOptionMsg&&a.text(c.firstOptionMsg+h.text().capitalize());p.change(function(){""!=$(this).val()&&f.actionsBySku(b,
$(this).val(),d,j)})},buyButtonSelectbox:function(a,c,b,d,j){A.bind("click",function(){var h,d,r;d=a.val();if(""==d)return alert("Selcione a especifica\u00e7\u00e3o \u201c"+b.find(".specification").text()+"\u201d"),!1;if("undefined"==typeof c.skus[d])return e("N\u00e3o foi poss\u00edvel obter o SKU na lista de especifica\u00e7\u00f5es");h=c.skus[d];r=function(c){c.Availability?(f.skuToCart(k,c.Id,void 0,j),jQuery(".boxPopUp2").vtexPopUp2()):alert("A especifica\u00e7\u00e3o \u201c"+a.find("[value="+
d+"]").text()+"\u201d esta indispon\u00edvel.")};"object"==typeof v[h]?r(v[h][0]):jQuery.ajax({url:"/produto/sku/"+h,data:"json",success:function(a,g,c){"object"!==typeof a?e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+h+"\u201d."):0!=c.status?(obj=a[0],v[obj.Id]=a,r(obj)):e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+h+"\u201d.")},error:function(){e("Erro ao obter informa\u00e7\u00f5es do sku \u201c"+h+"\u201d.")}});return!1})},buyButtonCheckbox:function(a,b,d,e,j){A.bind("click",
function(){var h=a.filter(":checked");if(2>b.specifications)0<h.length?(h=b.skus[h.val()],"undefined"===typeof h?(alert(c.skuNotLocated),document.location.href=e):"False"===h[1]?alert(c.skuUnavailable):(f.skuToCart(k,h[0],void 0,j),jQuery(".boxPopUp2").vtexPopUp2())):(h=d.find(".specification").eq(0).text()||" varia\u00e7\u00e3o do produto",alert(c.skuNotSelected.replace("#groupName",h)));else{var m=!1;d.each(function(){var a=jQuery(this);if(1>a.find("input:checked").length)return a=d.find(".specification").eq(a.index()).text()||
" varia\u00e7\u00e3o do produto",alert(c.skuNotSelected.replace("#groupName",a)),m=!0,!1});if(!m){var r=[];h.each(function(){r.push(jQuery(this).val())});h=b.skus[r.join(",")];"undefined"===typeof h?(alert(c.skuNotLocated),document.location.href=e):"False"===h[1]?alert(c.skuUnavailable):(f.skuToCart(k,h[0],void 0,j),jQuery(".boxPopUp2").vtexPopUp2())}}return!1})},specificationsReorder:function(a){var c={};"undefined"!==typeof a.specifications?c.specifications=a.specifications:e("N\u00e3o foi localizado o item \u201cspecifications\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");
if("undefined"!==typeof a.combination){var b=a.combination.length;c.combination={};for(var d=0;d<b;d++)for(var j in a.combination[d])if("string"===typeof a.combination[d][j])c.combination[j]=a.combination[d][j].split(",");else for(var h in a.combination[d][j][0]){c.combination[j]=a.combination[d][j][0][h].split(",");break}}else e("N\u00e3o foi localizado o item \u201ccombination\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");if("undefined"!==typeof a.skus){b=a.skus.length;c.skus={};for(d=
0;d<b;d++)for(j in a.skus[d])c.skus[j]=a.skus[d][j].split(",")}else e("N\u00e3o foi localizado o item \u201cskus\u201d do objeto com as especifica\u00e7\u00f5es de SKU.");return c},getSku:function(a){return a.hasClass("asynchronousBuyButton")?(a.attr("id")||"").replace("idprod",""):(a.attr("href")||"").split("dSku=")[1]||""},selectUniqueSku:function(a){a.each(function(){var a,c;a=$(this);c=a.find("input");1==c.length&&(c.attr("checked",!0).trigger("change").trigger("click"),a.hide())})},multipleSkuConfigCheckbox:function(a,
c,b,d,j){2<c.specifications&&e("Esta exten\u00e3o n\u00e3o foi testada com mais de dois tipos de SKUs","Alerta");a.filter(":first").find("input").each(function(){var a=jQuery(this),b=a.val(),d,g,j=!0;if("undefined"!=typeof b&&""!=b&&(d=c.combination[b],"undefined"!=typeof d)){g=d.length;for(var f=0;f<g;f++)"object"==typeof c.skus[b+","+d[f]]&&"True"==c.skus[b+","+d[f]][1]&&(j=!1);j&&a.addClass("item_unavaliable").next("label").addClass("item_unavaliable")}});b.bind("change",function(){var b,m,p;b=
jQuery(this);p=b.attr("id").split("_");m=p[1]||p.pop();a.not(":eq("+m+")").find("input").each(function(){var a=jQuery(this),g;g="0"==m?b.val()+","+a.val():a.val()+","+b.val();"object"==typeof c.skus[g]&&(b.is(":checked")&&a.is(":checked"))&&f.actionsBySku(c,g,d,j);"object"==typeof c.skus[g]&&"False"==c.skus[g][1]&&(a.addClass("item_unavaliable").next("label").addClass("item_unavaliable"),b.addClass("item_unavaliable").next("label").addClass("item_unavaliable"))})});f.selectUniqueSku(a);a.find("input").length<=
a.length&&e("Deve ser desenvolvida uma fun\u00e7\u00e3o p/ varia\u00e7\u00f5es de SKUs em que todas tem apenas uma op\u00e7\u00e3o","Aviso")},actionsBySku:function(a,b,d,l){var j,h,m,r,q,i,k,n,u,C;j=d.find("img");1>j.length&&(j=jQuery('<img src="" alt="" />'),d.append(j));h=a.skus[b][0];C=function(a){m=f.getImageUrl(a,c.skuThumbId);"string"==typeof m[0]?j.attr("src",m[0]):e("[2] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+h+"\u201d.");q=jQuery(c.regularPricePopupHtml.replace("#regularPrice",
f.numberFormat(a.ListPrice))).hide();i=jQuery(c.newPricePopupHtml.replace("#newPrice",f.numberFormat(a.Price)));n=jQuery(c.installmentPricePopupHtml.replace("#installmentQtt",a.BestInstallmentNumber).replace("#installmentValue",f.numberFormat(a.BestInstallmentValue))).hide();u=jQuery(c.fullPricePopupHtml).hide();k=jQuery("").add(q).add(i).add(n).add(u);a.Price<a.ListPrice&&q.show();1<a.BestInstallmentNumber?n.show():u.show();l.html(k)};"object"==typeof v[h]?C(v[h][0]):jQuery.ajax({url:"/produto/sku/"+
h,data:"json",success:function(a,c,b){"object"!==typeof a?e("[1] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+h+"\u201d."):0!=b.status?(r=a[0],v[r.Id]=a,C(r)):e("[3] N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+h+"\u201d.")},error:function(){e("N\u00e3o foi poss\u00edvel obter a imagem p/ o sku \u201c"+h+"\u201d.")}})},numberFormat:function(a){var c="",b="",c="",d,j,a=a.toFixed(2).split("."),b=a[0].split("");d=0;j=b.length;for(var h=a[0].length;0<h;h--)b=a[0].substr(h-
1,1),d++,0==d%3&&j>d&&(b="."+b),c=b+c;return c=c+","+a[1]},getImageUrl:function(a,c){var b=[];if(1>a.Images.length)return e("N\u00e3o foram encontradas imagens para o SKU: "+a.Id,"Alerta"),b;for(array in a.Images)for(img in a.Images[array])if(a.Images[array][img].ArchiveTypeId==c){b.push(a.Images[array][img].Path);break}return b},skuConfigCheckbox:function(a,c,b,d,j){a.each(function(){var h=jQuery(this),m=h.find("[type=radio]"),e;for(e in c.skus)"False"===c.skus[e][1]&&m.filter("[value='"+e+"']").addClass("item_unavaliable").next("label").addClass("item_unavaliable");
m.bind("change",function(){var e,l,i,k;k=1<c.specifications;e=jQuery(this);l=[];m.not(e).attr("checked",!1);i=e.val()||"_";"object"==typeof c.skus[i]&&e.is(":checked")&&f.actionsBySku(c,i,d,j);if(e.is(":checked")){if(b.removeClass("sku-picked").next("label").removeClass("sku-picked"),e.addClass("sku-picked").next("label").addClass("sku-picked"),k){var r=[(e.attr("name")||"").replace("espec_",""),e.val()||""];a.not(h).each(function(){var a=[];jQuery(this).find("[type=radio]").each(function(){a[r[0]]=
r[1];a[(this.attr("name")||"").replace("espec_","")]=this.val()||"";l.push(a)})})}}else e.removeClass("sku-picked").next("label").removeClass("sku-picked"),k&&b.removeClass("item_unavaliable").next("label").removeClass("item_unavaliable")})})},skuToCart:function(a,b,d,i){d=d||1;if(isNaN(parseInt(b)))return e("O SKU n\u00e3o \u00e9 um n\u00famero: \u201c"+b+"\u201d"),!1;if(isNaN(parseInt(d)))return e("A quantidade deve ser num\u00e9rica: \u201c"+d+"\u201d"),!1;var j=i||a.siblings(c.btnOverlayElem);
j.show();jQuery.ajax({url:"/Site/Carrinho.aspx?idSku="+b+"&quantidade="+d,success:function(a){f.skuToCartAjaxSuccess(j,b,a);f.updateCart()},error:function(){f.skuToCartAjaxError(j)}})},loadCart:function(a){(a||!d.hasClass("preLoaded"))&&jQuery.ajax({url:"/Site/Carrinho.aspx",success:function(a){f.skuToCartAjaxSuccess(k,0,a,!1);d.addClass("preLoaded");f.scrollAction()},error:function(){f.skuToCartAjaxError(k)}})},skuToCartAjaxSuccess:function(a,b,d,e){a.hide();if(-1<d.indexOf("Ocorreu um erro"))return f.skuToCartAjaxError();
a=jQuery(d);c.succesShow(t);switch(c.htmlFormat){case 1:f.formatCartItens(a,b);break;case 2:f.formatCartItens2(a,b)}("undefined"!==typeof e?e:1)&&f.displayCart();c.ajaxCallback()},skuToCartAjaxError:function(a){a.hide();e("A requisi\u00e7\u00e3o Ajax para adicionar/alterar o SKU no carrinho \n n\u00e3o obteve a resposta esperada. \n Foi retornado um texto contendo o termo \u201cOcorreu um erro\u201d.");alert(c.ajaxErroMsg);return!1},formatCartItens:function(b,d){var e=b.find(".carrinhoTable"),i=0;
if(1>e.length)return!1;e.find("tbody tr").each(function(){var b=jQuery("<li></li>"),e=jQuery(this),g=jQuery('<div class="cartSkuImage"></div>');e.find(".sku-imagem").appendTo(g);g.appendTo(b);var g=jQuery('<div class="cartSkuInfo"></div>'),l=e.find(".boxQuantidade"),k=l.attr("title")||"";a=parseInt(l.val());e.find("h4").appendTo(g);g.append('<div class="cartSkuUnitPrice">'+(e.find(".preco-unitario").html()||"").toString()+"</div>");var l=jQuery('<div class="cartSkuQtt"><span class="cartSkuQttTxt">'+
c.qttText+'<span class="vtexsc-skuQtt">'+(a||"")+"</span></span></div>"),p=l.find(".vtexsc-skuQtt");g.append(l);g.appendTo(b);g=jQuery('<div class="cartSkuActions"></div>');jQuery('<span class="cartSkuRemove">'+c.textRemove+"</span>").bind("click",function(){f.removeSku(b,(e.find("a.excluir").attr("href")||"").split("IdSkuRm=").pop())}).appendTo(g);var s=jQuery('<span class="cartSkuMoreOne">'+c.textMoreOne+"</span>").bind("click",function(){var c=f.changeQantity([b,p],k,a);isNaN(c)||(a=c)}),t=jQuery('<span class="cartSkuMinusOne">'+
c.textMinusOne+"</span>").bind("click",function(){var c=f.changeQantity([b,p],k,a,-1);isNaN(c)||(a=c)}),u=jQuery('<span class="cartSkuChangeQttWrap"></span>');u.append(s).append(t);l.append(u);g.append(u.clone());g.appendTo(b);"undefined"!==typeof d&&k==d&&c.resetNewItem(b.addClass("vtexsc-newItem"));0===i&&n.empty();b.append("<div class='vtexsc-overlay'></div>");b.appendTo(n);i++})},formatCartItens2:function(b,d){var e=b.find(".carrinhoTable"),l=0;if(1>e.length)return!1;e.find("tbody tr").each(function(){var b=
null,e=jQuery(this),g=jQuery("<tr></tr>");g.addClass(e.attr("class")||"");b=jQuery('<td class="cartSkuImage"></td>');e.find(".sku-imagem").appendTo(b);b.appendTo(g);b=jQuery('<td class="cartSkuName"></td>');e.find("h4").appendTo(b);b.appendTo(g);b=jQuery('<td class="cartSkuPrice"></td>');b.append('<div class="cartSkuUnitPrice">'+(e.find(".preco-unitario").html()||"").toString()+"</div>");b.appendTo(g);var b=jQuery('<td class="cartSkuQunatity"></td>'),i=e.find(".boxQuantidade"),k=i.attr("title")||
"";curQtt=parseInt(i.val());var i=jQuery('<div class="cartSkuQtt"><span class="cartSkuQttTxt">'+c.qttText+'<span class="vtexsc-skuQtt">'+(curQtt||"")+"</span></span></div>"),p=i.find(".vtexsc-skuQtt");b.append(i);b.appendTo(g);a["_"+k]=curQtt;b=jQuery('<td class="cartSkuActions"></td>');remove=jQuery('<span class="cartSkuRemove">'+c.textRemove+"</span>").bind("click",function(){f.removeSku(g,(e.find("a.excluir").attr("href")||"").split("IdSkuRm=").pop())}).appendTo(b);var s=jQuery('<span class="cartSkuMoreOne">'+
c.textMoreOne+"</span>").bind("click",function(){var b=f.changeQantity([g,p],k,a["_"+k]);isNaN(b)||(a["_"+k]=b)}),t=jQuery('<span class="cartSkuMinusOne">'+c.textMinusOne+"</span>").bind("click",function(){var b=f.changeQantity([g,p],k,a["_"+k],-1);isNaN(b)||(a["_"+k]=b)}),u=jQuery('<span class="cartSkuChangeQttWrap"></span>');u.append(s).append(t);i.append(u);b.append(u.clone());b.appendTo(g);"undefined"!==typeof d&&k==d&&c.resetNewItem(g.addClass("vtexsc-newItem"));0===l&&n.empty();g.find(">td").append("<div class='vtexsc-overlay'></div>");
g.appendTo(n);l++});f.totalCartFormat(e)},totalCartFormat:function(a){x.html(a.find("tfoot .subtotal .preco-total").text())},scrollNewItem:function(){n.parent().stop(!0,!0).animate({scrollTop:n.height()||0},"fast")},updateCart:function(){z.show();jQuery.ajax({url:"/no-cache/QuantidadeItensCarrinho.aspx",success:f.upCartAjaxSuccess,error:f.upCartAjaxError})},upCartAjaxError:function(){e("Erro ao tentar atualizar o carrinho!")},upCartAjaxSuccess:function(a){var b,a=jQuery(a);b=a.find(".total-cart").text();
x.text("R$ "+b.substring(b.search(/\d/)));a=a.filter(".cartInfoWrapper");0<a.length?jQuery(".cartInfoWrapper").html(a.html()):e("[Erro] O carrinho n\u00e3o foi atualizado pois \u201c.cartInfoWrapper\u201d n\u00e3o foi encontrado no retorno da requisi\u00e7\u00e3o.");z.hide()},displayCart:function(){c.cartShow(d,f.scrollNewItem);c.cartHide(d,f.hideCart,c.cartHideTime)},removeSku:function(a,b){var d=b||"";if(isNaN(parseInt(d)))return e("O SKU deve ser num\u00e9rico: \u201c"+d+"\u201d"),!1;var i=a.find(".vtexsc-overlay").show()||
k;jQuery.ajax({url:"/no-cache/CarrinhoRemove.aspx?IdSkuRm="+d,success:function(){2===c.htmlFormat?a.hide(function(){f.scrollAction()}).remove():a.slideUp(function(){f.scrollAction();jQuery(this).remove()});i.hide();f.updateCart()}})},scrollAction:function(){d.filter(":hidden").addClass("calculatingTheHeight").css("visibility","hidden").show();var a=n.parent();2===c.htmlFormat?(a.height(),n.find("tr:visible")):(a.height(),n.children().filter(":visible"));d.filter(".calculatingTheHeight").removeClass("calculatingTheHeight").hide().css("visibility",
"visible");E.unbind("click").bind("click",function(){var b=n.find("tr:first"),b=0<b.length?b:n.find("li:first");a.stop(!0,!0).animate({scrollTop:"+="+b.outerHeight(!0)+"px"},"fast")});w.unbind("click").bind("click",function(){var b=n.find("tr:first"),b=0<b.length?b:n.find("li:first");a.stop(!0,!0).animate({scrollTop:"-="+b.outerHeight(!0)+"px"},"fast")})},changeQantity:function(b,d,e,i){var j=i||1;if(2>e&&0>j)return e;var h=b[0].find(".vtexsc-overlay").show()||k,e=e+j;jQuery.ajax({url:"/no-cache/CarrinhoUpdate.aspx?IdSku="+
d+"&quantidade="+e,success:function(i){h.hide();if(-1<i.indexOf("Ocorreu um erro"))return f.skuToCartAjaxError(k);0<jQuery(i).filter(".cart-items-detail").length?(alert(c.changeQttError),a["_"+d]=e-j):b[1].text(e);f.updateCart()},error:function(){f.skuToCartAjaxError(k)}});return e},hideCart:function(a){a.slideUp()},mouseCartActions:function(){var a={mouseenter:function(){clearTimeout(vtexscCartHideTimeOut);c.cartShow(d,function(){})},mouseleave:function(){c.cartHide(d,f.hideCart,c.cartHideTime)}};
d.filter(":not(.mouseActivated)").bind(a).addClass("mouseActivated");b.filter(":not(.mouseActivated)").bind(a).addClass("mouseActivated")},onlyCart:function(){f.loadCart();f.mouseCartActions()}};if(s)f.onlyCart();else{switch(c.method){case 1:f.buyButtons()}f.loadCart();f.mouseCartActions();c.callback()}return l};